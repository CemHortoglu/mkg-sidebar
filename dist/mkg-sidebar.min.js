"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),mSidebar=function(){function mSidebar(){_classCallCheck(this,mSidebar),this.propertyName=null,this.items=[],this.options={baseURL:"",position:"left",closeButton:!0,closeOnBackgroundClick:!0,animationType:"css",defaultTitle:"",defaultFollow:!0,onOpen:null,onClose:null,autoCollapse:!1};for(var i=0;i<arguments.length;i++){var argument=arguments[i];if("string"==typeof argument)this.propertyName=argument;else if("[object Array]"==Object.prototype.toString.call(argument))for(var i2=0;i2<argument.length;i2++)this.addItem(argument[i2],!1);else if("object"===("undefined"==typeof argument?"undefined":_typeof(argument)))for(var variable in argument)this.options[variable]=argument[variable];else"function"==typeof argument&&(this.options.onOpen=argument)}var newBar=document.createElement("aside");return this.target=newBar,newBar.className+=" mSidebar mSidebar--"+this.options.position,newBar.innerHTML='<div class="mSidebar-container">\n            <header>\n                '+(this.options.closeButton?'<div class="mSidebar-close"></div>':"")+'\n                <div class="mSidebar-header"></div>\n            </header>\n            <div class="mSidebar-content"></div>\n            <footer class="mSidebar-footer"></footer>\n        </div>',this.refreshItems(),document.body.appendChild(newBar),this.propertyName&&eval("mSidebar."+this.propertyName+"=this"),this.options.closeButton&&newBar.querySelector(".mSidebar-close").addEventListener("click",this.close.bind(this)),newBar.addEventListener("click",this._onClick.bind(this)),this}return _createClass(mSidebar,[{key:"_itemToHTML",value:function(e){var t=this,r=e.title,i=e.text,a=e.link,n=e.follow,o=void 0===n?!0:n,s=e.items,l=void 0===s?[]:s,c=arguments.length<=1||void 0===arguments[1]?0:arguments[1];a&&0!==a.search(/^(https?|ftp):/)&&(a=this.options.baseURL.replace(/\/$/,"")+"/"+a.replace(/^\//,""));var d="";if(0===l.length)d='<a href="'+(a?a:"")+'" title="'+(r?r:i)+'"'+(o?"":' rel="nofollow"')+' class="mSidebar-item mSidebar--d'+c+'">'+i+"</a>";else{var u=a?'<a href="'+a+'" title="'+(r?r:i)+'"'+(o?"":' rel="nofollow"')+' class="mSidebar-collapse-header mSidebar--d'+c+'">'+i+"</a>":'<div class="mSidebar-collapse-header mSidebar--d'+c+' mSidebar-collapse--buttonrole">'+i+"</div>";d='\n            <div class="mSidebar-collapse mSidebar--d'+c+'">\n                <div class="mSidebar-collapse-button mSidebar--d'+c+'"></div>\n                '+u+'\n                <div class="mSidebar-collapse-items mSidebar--d'+(c+1)+'">\n                    '+l.reduce(function(e,r){return e+t._itemToHTML(r,c+1)},"")+"\n                </div>\n            </div>"}return d}},{key:"refreshItems",value:function(){var e="";for(var t in this.items)e+=this._itemToHTML(this.items[t]);return this.target.querySelector(".mSidebar-content").innerHTML=e,this}},{key:"setContent",value:function(e){return this.target.querySelector(".mSidebar-content").innerHTML=document.querySelector(e).innerHTML,this}},{key:"setHeader",value:function(e){return this.target.querySelector(".mSidebar-header").innerHTML=document.querySelector(e).innerHTML,this}},{key:"setFooter",value:function(e){return this.target.querySelector(".mSidebar-footer").innerHTML=document.querySelector(e).innerHTML,this}},{key:"removeItems",value:function(){return this.items=[],this.refreshItems(),this}},{key:"addItemFrom",value:function(e){for(var t=document.querySelectorAll(e),r=0;r<t.length;r++)this.addItem({title:t[r].getAttribute("title")?t[r].getAttribute("title"):this.options.defaultTitle,text:t[r].innerHTML.replace(/<[^>]+>/g,""),link:t[r].getAttribute("href")?t[r].getAttribute("href"):"/",follow:"nofollow"===t[r].getAttribute("rel")?!1:this.options.defaultFollow},!1);return this.refreshItems(),this}},{key:"addItem",value:function(e){var t=e.title,r=e.text,i=e.link,a=e.follow,n=void 0===a?!0:a,o=e.items,s=void 0===o?[]:o,l=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];if(0===arguments.length)return!1;if("string"==typeof arguments[0])t=arguments[0],r=arguments[0],i=arguments[0].toLowerCase().replace(/[^a-z0-9]/,"");else if("[object Array]"==Object.prototype.toString.call(arguments[0])){for(var s=arguments[0],c=0;c<s.length;c++)this.addItem(s[c],!1);return l&&this.refreshItems(),this}var d={title:t,text:r,link:i,follow:n,items:s};return this.items.push(d),l&&this.refreshItems(),this}}]),_createClass(mSidebar,[{key:"_onClick",value:function(e){e.target===this.target&&this.options.closeOnBackgroundClick&&this.close.call(this);var t=" "+e.target.className+" ";if(t.indexOf("mSidebar-collapse-button")>-1||t.indexOf("mSidebar-collapse--buttonrole")>-1){var r=e.target.parentNode;(" "+r.className+" ").indexOf(" mSidebar-collapse--open ")>-1?r.className=r.className.replace(/( |$)mSidebar-collapse--open/,""):r.className+=" mSidebar-collapse--open"}}},{key:"open",value:function(){return(" "+this.target.className+" ").indexOf(" mSidebar--close ")>-1?this.target.className=this.target.className.replace("mSidebar--close","mSidebar--open"):this.target.className+=" mSidebar--open",this.options.onOpen&&this.options.onOpen.call(this),this}},{key:"close",value:function(){return this.target.className=this.target.className.replace("mSidebar--open","mSidebar--close"),this.options.autoCollapse&&this.collapse(),this.options.onClose&&this.options.onClose.call(this),this}},{key:"toggle",value:function(){return(" "+this.target.className+" ").indexOf(" mSidebar--open ")>-1?this.close():this.open(),this}},{key:"collapse",value:function(){for(var e=this.target.querySelectorAll(".mSidebar-collapse--open"),t=0;t<e.length;t++)e[t].className=e[t].className.replace(/ ?mSidebar-collapse--open/,"");return this}},{key:"uncollapse",value:function(){for(var e=this.target.querySelectorAll(".mSidebar-collapse:not(.mSidebar-collapse--open)"),t=0;t<e.length;t++)e[t].className+=" mSidebar-collapse--open";return this}}]),mSidebar}();