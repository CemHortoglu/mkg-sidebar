"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),mSidebar=function(){function mSidebar(){_classCallCheck(this,mSidebar),this.propertyName=null,this.items=[],this.options={baseURL:"",position:"left",closeButton:!0,closeOnBackgroundClick:!0,animationType:"slide",defaultTitle:"",defaultFollow:!0,onOpen:null,onClose:null,autoCollapse:!1};for(var i=0;i<arguments.length;i++){var argument=arguments[i];if("string"==typeof argument)this.propertyName=argument;else if("[object Array]"==Object.prototype.toString.call(argument))for(var i2=0;i2<argument.length;i2++)this.addItem(argument[i2],!1);else if("object"===("undefined"==typeof argument?"undefined":_typeof(argument)))for(var variable in argument)this.options[variable]=argument[variable];else"function"==typeof argument&&(this.options.onOpen=argument)}var newBar=document.createElement("aside");return this.target=newBar,newBar.className+=" mSidebar mSidebar--"+this.options.animationType+" mSidebar--"+this.options.position,newBar.innerHTML='<div class="mSidebar-container">\n            <header>\n                '+(this.options.closeButton?'<div class="mSidebar-close"></div>':"")+'\n                <div class="mSidebar-header"></div>\n            </header>\n            <div class="mSidebar-content"></div>\n            <footer class="mSidebar-footer"></footer>\n        </div>',this.refreshItems(),document.body.appendChild(newBar),this.propertyName&&eval("mSidebar."+this.propertyName+"=this"),this.options.closeButton&&newBar.querySelector(".mSidebar-close").addEventListener("click",this.close.bind(this)),newBar.addEventListener("click",this._onClick.bind(this)),this}return _createClass(mSidebar,[{key:"_itemToHTML",value:function(e){var t=e.title,i=e.text,r=e.link,a=e.callback,n=void 0===a?null:a,o=e.follow,l=void 0===o?!0:o,s=e.items,c=void 0===s?[]:s,d=arguments.length<=1||void 0===arguments[1]?0:arguments[1];r&&0!==r.search(/^(https?|ftp):/)&&(r=this.options.baseURL.replace(/\/$/,"")+"/"+r.replace(/^\//,""));var u,m=document.createElement(r?"a":"div");if(m.textContent=i,r&&(m.setAttribute("href",r),m.setAttribute("title",t?t:i),m.setAttribute("follow",l?"follow":"nofollow")),n&&m.addEventListener("click",n.bind({title:t,text:i,link:r,follow:l,depth:d})),0===c.length)m.setAttribute("class","mSidebar-item mSidebar--d"+d),u=m;else{r?m.setAttribute("class","mSidebar-collapse-header mSidebar--d"+d):m.setAttribute("class","mSidebar-collapse-header mSidebar--d"+d+" mSidebar-collapse--buttonrole");u=document.createElement("div"),u.setAttribute("class","mSidebar-collapse mSidebar--d"+d),u.innerHTML='\n            <div class="mSidebar-collapse-button mSidebar--d'+d+'"></div>\n\n            <div class="mSidebar-collapse-items mSidebar--d'+(d+1)+'">\n            </div>',u.insertBefore(m,u.querySelector(".mSidebar-collapse-items")),c.forEach(function(e){u.querySelector(".mSidebar-collapse-items").appendChild(this._itemToHTML(e,d+1))}.bind(this))}return u}},{key:"refreshItems",value:function(){this.target.querySelector(".mSidebar-content").innerHTML="";for(var e in this.items)this.target.querySelector(".mSidebar-content").appendChild(this._itemToHTML(this.items[e]));return this}},{key:"setContent",value:function(e){return this.target.querySelector(".mSidebar-content").innerHTML=document.querySelector(e).innerHTML,this}},{key:"setHeader",value:function(e){return this.target.querySelector(".mSidebar-header").innerHTML=document.querySelector(e).innerHTML,this}},{key:"setFooter",value:function(e){return this.target.querySelector(".mSidebar-footer").innerHTML=document.querySelector(e).innerHTML,this}},{key:"removeItems",value:function(){return this.items=[],this.refreshItems(),this}},{key:"addItemFrom",value:function(e){for(var t=document.querySelectorAll(e),i=0;i<t.length;i++)this.addItem({title:t[i].getAttribute("title")?t[i].getAttribute("title"):this.options.defaultTitle,text:t[i].innerHTML.replace(/<[^>]+>/g,""),link:t[i].getAttribute("href")?t[i].getAttribute("href"):"/",callback:t[i].getAttribute("onClick")?t[i].getAttribute("onClick"):null,follow:"nofollow"===t[i].getAttribute("rel")?!1:this.options.defaultFollow},!1);return this.refreshItems(),this}},{key:"addItem",value:function(e){var t=e.title,i=e.text,r=e.link,a=e.callback,n=void 0===a?null:a,o=e.follow,l=void 0===o?!0:o,s=e.items,c=void 0===s?[]:s,d=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];if(0===arguments.length)return!1;if("string"==typeof arguments[0])t=arguments[0],i=arguments[0],r=arguments[0].toLowerCase().replace(/[^a-z0-9]/,"");else if("[object Array]"==Object.prototype.toString.call(arguments[0])){for(var c=arguments[0],u=0;u<c.length;u++)this.addItem(c[u],!1);return d&&this.refreshItems(),this}var m={title:t,text:i,link:r,callback:n,follow:l,items:c};return this.items.push(m),d&&this.refreshItems(),this}}]),_createClass(mSidebar,[{key:"_onClick",value:function(e){e.target===this.target&&this.options.closeOnBackgroundClick&&this.close.call(this);var t=" "+e.target.className+" ";if(t.indexOf("mSidebar-collapse-button")>-1||t.indexOf("mSidebar-collapse--buttonrole")>-1){var i=e.target.parentNode;(" "+i.className+" ").indexOf(" mSidebar-collapse--open ")>-1?i.className=i.className.replace(/( |$)mSidebar-collapse--open/,""):i.className+=" mSidebar-collapse--open"}}},{key:"open",value:function(){return(" "+this.target.className+" ").indexOf(" mSidebar--close ")>-1?this.target.className=this.target.className.replace("mSidebar--close","mSidebar--open"):this.target.className+=" mSidebar--open",this.options.onOpen&&this.options.onOpen.call(this),this}},{key:"close",value:function(){return this.target.className=this.target.className.replace("mSidebar--open","mSidebar--close"),this.options.autoCollapse&&this.collapse(),this.options.onClose&&this.options.onClose.call(this),this}},{key:"toggle",value:function(){return(" "+this.target.className+" ").indexOf(" mSidebar--open ")>-1?this.close():this.open(),this}},{key:"collapse",value:function(){for(var e=this.target.querySelectorAll(".mSidebar-collapse--open"),t=0;t<e.length;t++)e[t].className=e[t].className.replace(/ ?mSidebar-collapse--open/,"");return this}},{key:"uncollapse",value:function(){for(var e=this.target.querySelectorAll(".mSidebar-collapse:not(.mSidebar-collapse--open)"),t=0;t<e.length;t++)e[t].className+=" mSidebar-collapse--open";return this}}]),mSidebar}();